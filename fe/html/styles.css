:root{
    /* Colors */
    --bg1:#0b1020;
    --bg2:#0f1b3d;
    --card: rgba(15,23,48,.72);
    --border: rgba(38,50,85,.75);
    --text:#eaf0ff;
    --muted:#a9b6d8;

    --accent:#7aa7ff;
    --accent2:#65f0c7;

    --danger:#ff6b6b;

    /* Layout */
    --radius: 18px;
    --radius-sm: 14px;

    --shadow: 0 20px 60px rgba(0,0,0,.35);
    --shadow-soft: 0 10px 30px rgba(0,0,0,.22);

    --ring: 0 0 0 4px rgba(122,167,255,.14);

    --pad: 18px;
    --gap: 16px;
}

*{ box-sizing:border-box; }
html, body{ height:100%; }

body{
    margin:0;
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    color:var(--text);
    background:
            radial-gradient(1200px 600px at 20% 0%, rgba(122,167,255,.25), transparent 55%),
            radial-gradient(1000px 700px at 90% 20%, rgba(101,240,199,.18), transparent 60%),
            linear-gradient(160deg, var(--bg1), var(--bg2));
}

a{ color:inherit; text-decoration:none; }

.container{
    /* Breiter, aber trotzdem angenehm */
    width: min(1280px, calc(100% - 36px));
    margin: 0 auto;
    padding: 34px 0;
}

@media (max-width: 520px){
    .container{
        width: calc(100% - 24px);
        padding: 20px 0;
    }
}

/* Topbar */
.topbar{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap: 14px;
    margin-bottom: 22px;
}

/* Brand (Logo + Text) */
.brand{
    display:flex;
    align-items:center;
    gap: 16px;
    min-width: 0; /* prevents weird overflow on small screens */
}

.logo{
    width:58px;
    height:58px;
    border-radius: 20px;
    background: linear-gradient(135deg, rgba(122,167,255,.95), rgba(101,240,199,.85));
    box-shadow: 0 18px 50px rgba(0,0,0,.35);
    flex: 0 0 auto;
}

.brand h1{
    font-size: 22px;
    line-height: 1.1;
    margin:0;
    letter-spacing: .2px;
}

.brand p{
    margin:4px 0 0 0;
    color:var(--muted);
    font-size: 14px;
    line-height: 1.25;
}

@media (max-width: 520px){
    .logo{ width:48px; height:48px; border-radius: 16px; }
    .brand h1{ font-size: 19px; }
    .brand p{ font-size: 13px; }
}

/* Layout Grid */
.grid{
    display:grid;
    grid-template-columns: 1.2fr .8fr;
    gap: var(--gap);
    align-items: stretch;
}

@media (max-width: 900px){
    .grid{ grid-template-columns: 1fr; }
}

/* Cards */
.card{
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    padding: var(--pad);
    backdrop-filter: blur(10px);
    height: 100%;
}

.card h2{
    margin:0 0 10px 0;
    font-size: 18px;
    line-height: 1.2;
}

.muted{ color:var(--muted); }

/* Row helper */
.row{
    display:flex;
    gap: 10px;
    flex-wrap: wrap;
    align-items:center;
}

/* Tabs */
.tabs{
    display:flex;
    gap:8px;
    padding:6px;
    border-radius: 999px;
    border: 1px solid var(--border);
    background: rgba(15,23,48,.55);
    width: fit-content;
}

.tab{
    border:0;
    background: transparent;
    color: var(--muted);
    padding: 10px 12px;
    border-radius: 999px;
    cursor:pointer;
    font-weight: 700;
    letter-spacing:.2px;
}

.tab.active{
    color: var(--text);
    background: rgba(122,167,255,.18);
    outline: 1px solid rgba(122,167,255,.35);
}

/* Forms */
.form{
    margin-top: 14px;
    display:grid;
    gap: 12px;
}

label{
    display:grid;
    gap: 6px;
    font-size: 13px;
    color: var(--muted);
}

input{
    width:100%;
    padding: 12px 12px;
    border-radius: var(--radius-sm);
    border: 1px solid var(--border);
    background: rgba(10,16,32,.60);
    color: var(--text);
    outline: none;
}

input:focus-visible{
    border-color: rgba(122,167,255,.65);
    box-shadow: var(--ring);
}

/* Buttons */
.btn{
    border: 1px solid var(--border);
    background: rgba(122,167,255,.16);
    color: var(--text);
    padding: 11px 14px;
    border-radius: var(--radius-sm);
    cursor:pointer;
    font-weight: 800;
    letter-spacing: .2px;
    box-shadow: var(--shadow-soft);
    transition: transform .08s ease, filter .12s ease;
}

.btn:hover{ filter: brightness(1.06); }
.btn:active{ transform: translateY(1px); }
.btn:focus-visible{ box-shadow: var(--shadow-soft), var(--ring); }

.btn.primary{
    border-color: rgba(122,167,255,.55);
    background: linear-gradient(135deg, rgba(122,167,255,.35), rgba(101,240,199,.18));
}

.btn.logout{
    border-color: rgba(255,107,107,.45);
    background: rgba(255,107,107,.12);
}

.btn.logout:hover{ filter: brightness(1.06); }

/* Pills */
.pill{
    display:inline-flex;
    align-items:center;
    gap:8px;
    padding: 11px 14px;
    border-radius: var(--radius-sm);
    border: 1px solid var(--border);
    background: rgba(15,23,48,.55);
    color: var(--muted);
    font-size: 13px;
}

.pill:hover { filter: brightness(1.06); }
.pill:focus-visible { box-shadow: var(--ring); }

/* Toast messages */
.toast{
    margin-top: 10px;
    padding: 10px 12px;
    border-radius: var(--radius-sm);
    border: 1px solid var(--border);
    background: rgba(15,23,48,.55);
    color: var(--muted);
}

.toast.error{
    border-color: rgba(255,107,107,.45);
    background: rgba(255,107,107,.10);
    color: #ffd0d0;
}

.toast.ok{
    border-color: rgba(101,240,199,.45);
    background: rgba(101,240,199,.10);
    color: #d0fff1;
}

/* Profile: Avatar row */
.profileHeader{
    display:flex;
    gap: 14px;
    align-items:center;
    margin-top: 12px;
    margin-bottom: 10px;
}

.avatarBox{
    width: 76px;
    height: 76px;
    border-radius: 18px;
    border: 1px solid var(--border);
    background: rgba(10,16,32,.60);
    overflow: hidden;
    display: grid;
    place-items: center;
    flex: 0 0 auto;
}

.avatarBox img{
    width: 100%;
    height: 100%;
    object-fit: cover;
    display:block;
}

.avatarInitial{
    font-weight: 900;
    font-size: 22px;
    color: var(--text);
    opacity: 0.95;
}

.profileMeta{
    display: grid;
    gap: 6px;
    min-width: 0;
}

.profileMeta .nameLine{
    font-size: 18px;
    font-weight: 900;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.profileMeta .mailLine{
    color: var(--muted);
    font-size: 13px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* File input a bit nicer */
input[type="file"]{
    padding: 10px;
}

/* Small avatar in topbar */
.avatarLink{
    width: 34px;
    height: 34px;
    border-radius: 12px;
    border: 1px solid var(--border);
    background: rgba(10,16,32,.60);
    display: grid;
    place-items: center;
    overflow: hidden;
}

.avatarLink img{
    width: 100%;
    height: 100%;
    object-fit: cover;
    display:block;
}

.avatarLink span{
    font-weight: 900;
    font-size: 14px;
    color: var(--text);
}

/* Motion preferences */
@media (prefers-reduced-motion: reduce){
    .btn{ transition: none; }
}



/* --- APPEND TO styles.css --- */

/* Form Selects (Matches your existing input style) */
select {
    width: 100%;
    padding: 12px 12px;
    border-radius: var(--radius-sm);
    border: 1px solid var(--border);
    background: rgba(10,16,32,.60);
    color: var(--text);
    outline: none;
    appearance: none; /* Removes default OS arrow */
    background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%237aa7ff%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E");
    background-repeat: no-repeat;
    background-position: right 12px top 50%;
    background-size: 12px auto;
    cursor: pointer;
}
select:focus {
    border-color: rgba(122,167,255,.65);
    box-shadow: var(--ring);
}

/* Modal / Popup Overlay */
.modal-overlay {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background-color: rgba(0, 5, 15, 0.85); /* Darker backdrop */
    backdrop-filter: blur(5px);
    z-index: 1000;
    display: none; /* Hidden by default */
    justify-content: center;
    align-items: center;
    opacity: 0;
    transition: opacity 0.2s ease;
}

.modal-overlay.open {
    display: flex;
    opacity: 1;
}

/* Modal Content - Inherits from .card but centered */
.modal-box {
    width: 90%;
    max-width: 420px;
    background: var(--bg2); /* Solid background for legibility */
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 24px;
    box-shadow: var(--shadow);
    transform: translateY(20px);
    transition: transform 0.2s ease;
}

.modal-overlay.open .modal-box {
    transform: translateY(0);
}

/* Room View Styles */
.room-container {
    text-align: center;
    padding-top: 40px;
    animation: fadeIn 0.5s ease;
}

.room-code-badge {
    display: inline-block;
    background: rgba(0,0,0,0.3);
    padding: 8px 16px;
    border-radius: var(--radius-sm);
    border: 1px solid var(--border);
    font-family: monospace;
    font-size: 1.4rem;
    letter-spacing: 2px;
    color: var(--accent2);
    margin-top: 10px;
}

.timer-display {
    font-size: 5rem;
    font-weight: 800;
    font-variant-numeric: tabular-nums;
    margin: 30px 0;
    text-shadow: 0 10px 30px rgba(0,0,0,0.5);
}

.task-focus {
    font-size: 1.5rem;
    color: var(--text);
    margin-bottom: 40px;
}

/* --- THEMES (Overrides Body Background) --- */

/* Forest Theme */
body.theme-forest {
    background: 
        radial-gradient(circle at 50% 0%, rgba(101, 240, 199, 0.15), transparent 60%),
        linear-gradient(180deg, #132a13 0%, #061206 100%);
}
body.theme-forest .timer-display { color: #84fab0; }

/* Space Theme */
body.theme-space {
    background: 
        radial-gradient(circle at 80% 20%, rgba(189, 116, 255, 0.2), transparent 50%),
        linear-gradient(180deg, #1a0b2e 0%, #090312 100%);
}
body.theme-space .timer-display { color: #d4a7ff; }

/* Cozy Theme (Default-ish warm) */
body.theme-cozy {
    background: 
        radial-gradient(circle at 20% 20%, rgba(255, 175, 123, 0.15), transparent 60%),
        linear-gradient(180deg, #2e1a15 0%, #120705 100%);
}
body.theme-cozy .timer-display { color: #ffaf7b; }

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

/* ========================================= */
/* VIRTUAL ROOM ADDITIONS (Append this)    */
/* ========================================= */

/* 1. The Main Room Container */
/* This forces the room to cover your blue dashboard background */
.room-scene {
    position: fixed;       /* Sit on top of everything */
    top: 0; left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 10;           /* Higher than normal content */
    
    background-color: #1a1a1a; /* Fallback color if image fails */
    background-size: cover;
    background-position: center;
    
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    animation: fadeIn 0.8s ease;
}

@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

/* 2. The Theme Images */
/* These map to the values in your dropdown: "cozy", "forest", "space" */

body.theme-cozy .room-scene {
    background-image: url('https://images.unsplash.com/photo-1670996324046-f489f28de4e4?w=1600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Nnx8ZmlyZXBsYWNlJTIwcm9vbXxlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop'); 
}

body.theme-forest .room-scene {
    background-image: url('https://images.unsplash.com/photo-1701156853677-67182eaa0fa8?w=1600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8Zm9yZXN0JTIwcm9vbXxlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop');
}

body.theme-space .room-scene {
    background-image: url('https://images.unsplash.com/photo-1465101162946-4377e57745c3?w=1600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8OHx8b3V0ZXIlMjBzcGFjZXxlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop');
}

body.theme-default .room-scene {
    background-image: url('https://plus.unsplash.com/premium_photo-1661875977781-adbb21036841?w=1600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTd8fGxpYnJhcnl8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop');
}

/* 3. The HUD (Top Bar) */
.room-hud {
    padding: 20px;
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    background: linear-gradient(to bottom, rgba(0,0,0,0.8), transparent);
}

.room-info-badge {
    background: rgba(255, 255, 255, 0.95);
    color: #000;
    padding: 8px 12px;
    border-radius: 8px;
    font-weight: bold;
    font-size: 0.9rem;
    box-shadow: 0 4px 10px rgba(0,0,0,0.3);
}

/* 4. The Timer Display */
.hud-timer-box {
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(8px);
    padding: 10px 18px;
    border-radius: 12px;
    border: 1px solid rgba(255,255,255,0.2);
    text-align: right;
    color: white;
}

.mini-timer {
    font-size: 2rem;
    font-weight: 700;
    font-variant-numeric: tabular-nums;
    line-height: 1;
    color: #65f0c7; /* Your accent2 color */
}

.mini-task {
    font-size: 0.8rem;
    opacity: 0.9;
    margin-top: 4px;
    color: #ccc;
}

/* 5. The Floor (Avatar Area) */
.room-floor {
    flex: 1;
    background: linear-gradient(to top, rgba(0,0,0,0.4), transparent);
    position: relative; /* Essential for absolute children */
    overflow: hidden;   /* Keep avatars inside */
    /*border-top: 1px solid #eee;*/
}

/* 6. Avatar Characters */
.avatar-char {
    display: flex;
    flex-direction: column;
    align-items: center;

    /* RESTORED: Absolute positioning for Drag & Drop */
    position: absolute;
    /* RESTORED: Center the anchor point */
    transform: translate(-50%, -50%);

    cursor: grab; /* Hand cursor */
    user-select: none; /* Prevent text selection */

    /* Smooth movement only for non-drag updates */
    transition: transform 0.2s, top 0.2s, left 0.2s;

    /* Ensure it sits above the floor */
    z-index: 10;
}

.avatar-char:hover {
    transform: translate(-50%, -50%) translateY(-8px) scale(1.05);
    z-index: 20; /* Bring hovered avatar to front */
}

/* RESTORED: Dragging State */
.avatar-char:active {
    cursor: grabbing;
    transition: none; /* Disable smoothing for instant drag response */
    /* When dragging, we remove the hover 'lift' so it feels grounded to mouse */
    transform: translate(-50%, -50%) scale(1.05);
    z-index: 1000; /* Always on top */
}
.char-body {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    border: 3px solid white;
    box-shadow: 0 0 20px rgba(255,255,255,0.4);

    /* Image fitting */
    background-color: #888;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
}

.char-name {
    margin-top: 8px;
    background: rgba(0,0,0,0.8);
    color: white;
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: bold;
    text-align: center;
    white-space: nowrap; /* Prevent name breaking */
    pointer-events: none; /* Let clicks pass through text to avatar */
}

/* 7. Controls (Bottom Right) */
.room-controls {
    position: absolute;
    bottom: 20px;
    right: 20px;
}
.reaction-menu {
    position: fixed;
    background: white;
    padding: 8px 12px;
    border-radius: 20px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    display: flex;
    gap: 10px;
    z-index: 9999;
    animation: popIn 0.2s ease-out;
}

.reaction-menu span {
    font-size: 1.5rem;
    cursor: pointer;
    transition: transform 0.1s;
}

.reaction-menu span:hover {
    transform: scale(1.3);
}

@keyframes popIn {
    from { transform: scale(0.5); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
}



.floating-reaction {
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    font-size: 2.5rem;
    pointer-events: none;
    animation: floatUp 1.5s ease-out forwards;
    z-index: 100;
    text-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

@keyframes floatUp {
    0% {
        opacity: 1;
        top: -10px;
        transform: translateX(-50%) scale(0.5);
    }
    20% {
        transform: translateX(-50%) scale(1.2);
    }
    100% {
        opacity: 0;
        top: -100px; /* Float upwards */
        transform: translateX(-50%) scale(1);
    }
}
.emoji-section {
    margin-top: 24px;
    padding-top: 20px;
    border-top: 1px solid var(--border);
}

.emoji-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(36px, 1fr));
    gap: 8px;
    max-height: 180px;
    overflow-y: auto;
    margin-top: 14px;
    padding: 8px;
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    background: rgba(0,0,0,0.2);
}

.emoji-btn {
    font-size: 24px;
    cursor: pointer;
    background: transparent;
    border: 1px solid transparent;
    border-radius: 8px;
    transition: all 0.1s;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 4px;
}

.emoji-btn:hover {
    background: rgba(255,255,255,0.1);
    transform: scale(1.1);
}

.emoji-btn.active {
    background: var(--accent);
    border-color: rgba(255,255,255,0.5);
    box-shadow: 0 0 8px var(--accent);
}

.mashup-controls {
    display: flex;
    gap: 12px;
    align-items: center;
    justify-content: center;
    margin: 15px 0;
}

.mashup-slot {
    width: 58px;
    height: 58px;
    border: 2px dashed var(--muted);
    border-radius: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 32px;
    cursor: pointer;
    transition: border-color 0.2s;
    background: rgba(0,0,0,0.1);
}

.mashup-slot.selected {
    border-color: var(--accent);
    background: rgba(122,167,255,0.15);
}

.mashup-result {
    width: 80px;
    height: 80px;
    border-radius: 20px;
    background: var(--bg1);
    border: 1px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    margin-left: 10px;
    box-shadow: var(--shadow-soft);
}

.mashup-result img {
    width: 100%;
    height: 100%;
    object-fit: contain;
}
